<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>System Monitor — Rust</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;600;700&display=swap"
        rel="stylesheet" />
    <style type="text/tailwindcss">
        @theme {
        --font-mono: "JetBrains Mono", monospace;
        --color-bg:        #0a0c10;
        --color-surface:   #0f1117;
        --color-border:    #1e2330;
        --color-rust:      #ce422b;
        --color-rust-dim:  #7a1f10;
        --color-accent:    #ff4d00;
        --color-green:     #39d353;
        --color-yellow:    #f0c040;
        --color-red:       #ff4d4d;
        --color-blue:      #4da6ff;
        --color-purple:    #a78bfa;
        --color-muted:     #4a5568;
        --color-text:      #e2e8f0;
      }

      body {
        font-family: var(--font-mono);
        background-color: var(--color-bg);
        color: var(--color-text);
      }

      /* blink animation for status dot */
      @keyframes blink {
        0%, 100% { opacity: 1; }
        50%       { opacity: 0.2; }
      }
      .animate-blink { animation: blink 1.2s ease-in-out infinite; }

      /* rust logo pulse */
      @keyframes rust-pulse {
        0%, 100% { box-shadow: 0 0 16px 2px #ce422b55; }
        50%       { box-shadow: 0 0 28px 6px #ce422b99; }
      }
      .animate-rust-pulse { animation: rust-pulse 2s ease-in-out infinite; }

      /* ring progress via stroke-dashoffset (set by JS) */
      .ring-fill {
        stroke-linecap: round;
        transition: stroke-dashoffset 0.9s ease, stroke 0.4s;
      }
    </style>
</head>

<body class="min-h-screen overflow-x-hidden text-[13px]">

    <!-- ── header ─────────────────────────────────────────────────── -->
    <header class="flex items-center justify-between px-6 py-4 border-b border-border"
        style="background: linear-gradient(90deg, rgba(206,66,43,0.08) 0%, transparent 60%)">
        <div class="flex items-center gap-3">
            <!-- rust logo -->
            <div class="w-9 h-9 rounded-full bg-rust flex items-center justify-center text-lg animate-rust-pulse">R
            </div>

            <div>
                <h1 class="text-[18px] font-bold tracking-tight">
                    System Monitor —
                    <span class="text-rust">Rust</span>
                </h1>
                <p class="text-muted text-[11px]" id="uptime">uptime: 0h 0m 0s</p>
            </div>
        </div>

        <div class="flex items-center gap-3">
            <!-- simulation badge -->
            <span class="px-2 py-0.5 rounded text-[9px] font-bold tracking-widest uppercase
                 bg-rust/15 text-rust border border-rust/30">simulation</span>

            <!-- live dot -->
            <span class="w-2 h-2 rounded-full bg-green animate-blink shadow-[0_0_6px_#39d353]"></span>

            <!-- clock -->
            <span class="text-muted text-[10px]" id="clock">--:--:--</span>
        </div>
    </header>

    <!-- ── main grid ──────────────────────────────────────────────── -->
    <div class="grid gap-px bg-border" style="
        grid-template-columns: 1fr 1fr;
        grid-template-rows: auto auto auto;
        height: calc(100vh - 73px);
      ">
        <!-- panel: cpu -->
        <div class="bg-surface p-5 overflow-hidden" style="grid-column:1; grid-row:1">
            <p class="section-label">CPU</p>

            <!-- big number + model -->
            <div class="flex items-baseline gap-2 mb-4">
                <span id="cpu-total-val" class="text-[52px] font-bold leading-none text-accent"
                    style="text-shadow: 0 0 28px rgba(255,77,0,0.3)">0</span>
                <span class="text-muted text-base">%</span>

                <div class="ml-auto text-right">
                    <p class="text-[10px] text-muted" id="cpu-model">—</p>
                    <p class="text-[10px] text-muted" id="cpu-cores">— cores</p>
                </div>
            </div>

            <!-- core rings -->
            <div class="grid grid-cols-4 gap-1.5" id="cores-grid"></div>

            <!-- sparkline -->
            <canvas id="cpu-sparkline" class="w-full mt-3" style="height:40px"></canvas>
        </div>

        <!-- panel: processes -->
        <div class="bg-surface p-5 overflow-auto" style="grid-column:2; grid-row:1/3">
            <p class="section-label">Processes</p>

            <table class="w-full border-collapse">
                <thead>
                    <tr class="text-[9px] tracking-widest uppercase text-muted border-b border-border">
                        <th class="text-left pb-2 pr-2">Process</th>
                        <th class="text-left pb-2 pr-2">PID</th>
                        <th class="text-left pb-2 pr-2">CPU</th>
                        <th class="text-left pb-2">RAM</th>
                    </tr>
                </thead>
                <tbody id="proc-tbody"></tbody>
            </table>
        </div>

        <!-- panel: ram + disks -->
        <div class="bg-surface p-5 overflow-hidden" style="grid-column:1; grid-row:2">
            <p class="section-label">Memory</p>

            <!-- arc gauge -->
            <div class="flex justify-center my-2" id="mem-arc-container"></div>

            <!-- stats row -->
            <div class="grid grid-cols-3 gap-2 mt-3" id="mem-info-grid"></div>

            <!-- disks -->
            <div class="mt-4">
                <p class="section-label">Disks</p>
                <div id="disks-container"></div>
            </div>
        </div>

        <!-- panel: history chart -->
        <div class="bg-surface px-5 py-4" style="grid-column:1/3; grid-row:3">
            <p class="section-label">CPU + RAM History</p>

            <div class="flex gap-4 mb-2">
                <div class="flex items-center gap-1.5 text-[10px] text-muted">
                    <span class="w-2 h-2 rounded-full bg-accent"></span>CPU
                </div>
                <div class="flex items-center gap-1.5 text-[10px] text-muted">
                    <span class="w-2 h-2 rounded-full bg-blue"></span>RAM
                </div>
            </div>

            <canvas id="historyChart" class="w-full" style="height:60px"></canvas>
        </div>
    </div>

    <!-- ── inline styles for repeated patterns ───────────────────── -->
    <style>
        .section-label {
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--color-muted);
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-label::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--color-border);
        }
    </style>

    <script>
        // ── constants ────────────────────────────────────────────────
        const NUM_CORES = 8;
        const HISTORY_LEN = 60;
        const RAM_TOTAL = 32;

        const C = {
            bg: '#0a0c10',
            surface: '#0f1117',
            border: '#1e2330',
            accent: '#ff4d00',
            green: '#39d353',
            yellow: '#f0c040',
            red: '#ff4d4d',
            blue: '#4da6ff',
            purple: '#a78bfa',
            muted: '#4a5568',
            text: '#e2e8f0',
        };

        // ── state ────────────────────────────────────────────────────
        let cpuHistory = Array(HISTORY_LEN).fill(0);
        let ramHistory = Array(HISTORY_LEN).fill(0);
        let uptimeSeconds = 0;

        const PROCESSES = [
            { name: 'firefox', pid: 1234 },
            { name: 'code', pid: 2341 },
            { name: 'cargo', pid: 3412 },
            { name: 'rustc', pid: 4123 },
            { name: 'node', pid: 5231 },
            { name: 'postgres', pid: 6312 },
            { name: 'sysmon', pid: 7421 },
            { name: 'docker', pid: 8132 },
            { name: 'nginx', pid: 9213 },
            { name: 'bash', pid: 1032 },
        ];

        const DISKS = [
            { name: '/', used: 180, total: 500 },
            { name: '/home', used: 320, total: 1000 },
            { name: '/tmp', used: 4, total: 20 },
        ];

        // detect simulated os for cpu model label
        const SIM_OS = (() => {
            const ua = navigator.userAgent;
            if (ua.includes('Mac')) return { model: 'Apple M1 Pro', cores: 10 };
            if (ua.includes('Windows')) return { model: 'Intel Core i7-12700K', cores: 12 };
            return { model: 'AMD Ryzen 7 5800X', cores: 8 };
        })();

        document.getElementById('cpu-model').textContent = SIM_OS.model;
        document.getElementById('cpu-cores').textContent = SIM_OS.cores + ' cores';

        // ── helpers ──────────────────────────────────────────────────
        function smooth(prev, min, max, delta) {
            return Math.max(min, Math.min(max, prev + (Math.random() - 0.5) * delta));
        }

        let coreValues = Array(NUM_CORES).fill(0).map(() => 20 + Math.random() * 60);
        let ramUsed = 8.4;
        let procCpus = PROCESSES.map(() => Math.random() * 30);
        let procMems = PROCESSES.map(() => 100 + Math.random() * 2000);

        function coreColor(v) {
            return v > 80 ? C.red : v > 50 ? C.yellow : C.green;
        }

        // ── init core rings ──────────────────────────────────────────
        function initCores() {
            const grid = document.getElementById('cores-grid');
            const R = 16, circ = 2 * Math.PI * R;
            grid.innerHTML = Array.from({ length: NUM_CORES }, (_, i) => `
          <div class="bg-bg border border-border rounded-md p-1.5 text-center">
            <p class="text-[9px] text-muted mb-1">C${i}</p>
            <div class="relative w-9 h-9 mx-auto">
              <svg width="36" height="36" viewBox="0 0 36 36" style="transform:rotate(-90deg)">
                <circle cx="18" cy="18" r="${R}" fill="none" stroke="${C.border}" stroke-width="3"/>
                <circle id="cr-${i}" cx="18" cy="18" r="${R}" fill="none" stroke-width="3"
                  class="ring-fill"
                  stroke-dasharray="${circ}"
                  stroke-dashoffset="${circ}"/>
              </svg>
              <div id="cp-${i}"
                class="absolute inset-0 flex items-center justify-center text-[9px] font-semibold">
                0%
              </div>
            </div>
          </div>`).join('');
        }

        function updateCores() {
            const R = 16, circ = 2 * Math.PI * R;
            let total = 0;
            for (let i = 0; i < NUM_CORES; i++) {
                coreValues[i] = smooth(coreValues[i], 2, 98, 15);
                total += coreValues[i];
                const offset = circ * (1 - coreValues[i] / 100);
                const color = coreColor(coreValues[i]);
                const ring = document.getElementById(`cr-${i}`);
                const pct = document.getElementById(`cp-${i}`);
                if (ring) { ring.style.strokeDashoffset = offset; ring.style.stroke = color; }
                if (pct) pct.textContent = Math.round(coreValues[i]) + '%';
            }
            const avg = total / NUM_CORES;
            const el = document.getElementById('cpu-total-val');
            el.textContent = Math.round(avg);
            el.style.color = avg > 80 ? C.red : avg > 50 ? C.yellow : C.accent;
            return avg;
        }

        // ── ram arc ──────────────────────────────────────────────────
        function initMemArc() {
            document.getElementById('mem-arc-container').innerHTML = `
          <svg width="160" height="90" viewBox="0 0 160 90">
            <path d="M10,80 A70,70 0 0,1 150,80"
              fill="none" stroke="${C.border}" stroke-width="12" stroke-linecap="round"/>
            <path id="ram-arc" d="M10,80 A70,70 0 0,1 150,80"
              fill="none" stroke="${C.blue}" stroke-width="12" stroke-linecap="round"
              stroke-dasharray="220" stroke-dashoffset="220"
              style="transition: stroke-dashoffset 1s ease"/>
            <text id="ram-big" x="80" y="68" text-anchor="middle"
              fill="${C.text}" font-family="JetBrains Mono,monospace"
              font-size="22" font-weight="700">0</text>
            <text x="80" y="82" text-anchor="middle"
              fill="${C.muted}" font-family="JetBrains Mono,monospace" font-size="10">
              GB used
            </text>
          </svg>`;
        }

        function updateRam() {
            ramUsed = smooth(ramUsed, 4, 28, 0.5);
            const pct = ramUsed / RAM_TOTAL;
            const arc = document.getElementById('ram-arc');
            const big = document.getElementById('ram-big');
            if (arc) arc.style.strokeDashoffset = 220 * (1 - pct);
            if (big) big.textContent = ramUsed.toFixed(1);

            const free = (RAM_TOTAL - ramUsed).toFixed(1);
            document.getElementById('mem-info-grid').innerHTML = `
          ${statCard(ramUsed.toFixed(1), 'GB Used', C.red)}
          ${statCard(free, 'GB Free', C.green)}
          ${statCard(RAM_TOTAL, 'GB Total', C.muted)}`;

            return pct * 100;
        }

        function statCard(val, label, color) {
            return `
          <div class="bg-bg border border-border rounded-md p-2 text-center">
            <p class="text-[15px] font-bold" style="color:${color}">${val}</p>
            <p class="text-[9px] text-muted mt-0.5">${label}</p>
          </div>`;
        }

        // ── processes ────────────────────────────────────────────────
        function updateProcesses() {
            procCpus = procCpus.map(v => smooth(v, 0.1, 45, 5));
            procMems = procMems.map(v => smooth(v, 50, 3000, 80));

            const sorted = PROCESSES
                .map((p, i) => ({ ...p, cpu: procCpus[i], mem: procMems[i] }))
                .sort((a, b) => b.cpu - a.cpu);

            document.getElementById('proc-tbody').innerHTML = sorted.slice(0, 10).map(p => {
                const cc = p.cpu > 30 ? C.red : p.cpu > 15 ? C.yellow : C.green;
                const memGB = (p.mem / 1024).toFixed(1);
                const memPct = Math.min(p.mem / 3000 * 100, 100);
                return `
            <tr class="border-b border-border/40 hover:bg-white/[0.02] transition-colors">
              <td class="py-1.5 pr-2 font-semibold text-[11px] max-w-[120px]
                          overflow-hidden text-ellipsis whitespace-nowrap">${p.name}</td>
              <td class="py-1.5 pr-2 text-muted text-[10px]">${p.pid}</td>
              <td class="py-1.5 pr-2">
                ${miniBar(p.cpu, 100, cc)}
                <span class="text-[10px]" style="color:${cc}">${p.cpu.toFixed(1)}%</span>
              </td>
              <td class="py-1.5">
                ${miniBar(memPct, 100, C.purple)}
                <span class="text-[10px] text-purple">${memGB}G</span>
              </td>
            </tr>`;
            }).join('');
        }

        function miniBar(val, max, color) {
            const pct = Math.min(val / max * 100, 100);
            return `
          <div class="h-1 rounded-full mb-0.5 overflow-hidden" style="background:${C.border}">
            <div class="h-full rounded-full transition-all duration-700"
              style="width:${pct}%; background:${color}"></div>
          </div>`;
        }

        // ── disks ────────────────────────────────────────────────────
        function renderDisks() {
            document.getElementById('disks-container').innerHTML = DISKS.map(d => {
                const pct = (d.used / d.total * 100).toFixed(0);
                return `
            <div class="flex items-center gap-2 mb-2">
              <span class="text-[10px] text-muted w-12 shrink-0">${d.name}</span>
              <div class="flex-1 h-1.5 rounded-full overflow-hidden" style="background:${C.border}">
                <div class="h-full rounded-full"
                  style="width:${pct}%;
                         background: linear-gradient(90deg, ${C.purple}, ${C.blue})">
                </div>
              </div>
              <span class="text-[10px] w-9 text-right">${pct}%</span>
              <span class="text-[10px] text-muted w-24 text-right">${d.used}/${d.total} GB</span>
            </div>`;
            }).join('');
        }

        // ── history chart ────────────────────────────────────────────
        function drawHistory() {
            const canvas = document.getElementById('historyChart');
            if (!canvas) return;
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            const ctx = canvas.getContext('2d');
            ctx.scale(dpr, dpr);
            const W = rect.width, H = rect.height;
            ctx.clearRect(0, 0, W, H);

            // grid lines
            ctx.strokeStyle = C.border;
            ctx.lineWidth = 0.5;
            [25, 50, 75].forEach(y => {
                const py = H - (y / 100) * H;
                ctx.beginPath(); ctx.moveTo(0, py); ctx.lineTo(W, py); ctx.stroke();
            });

            // line + gradient fill
            const drawLine = (data, color) => {
                ctx.beginPath();
                ctx.strokeStyle = color;
                ctx.lineWidth = 1.5;
                ctx.shadowBlur = 6;
                ctx.shadowColor = color;
                data.forEach((v, i) => {
                    const x = (i / (HISTORY_LEN - 1)) * W;
                    const y = H - (v / 100) * H;
                    i === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
                });
                ctx.stroke();
                ctx.shadowBlur = 0;

                // area fill
                const last = data.length - 1;
                ctx.lineTo((last / (HISTORY_LEN - 1)) * W, H);
                ctx.lineTo(0, H);
                ctx.closePath();
                const grd = ctx.createLinearGradient(0, 0, 0, H);
                grd.addColorStop(0, color + '33');
                grd.addColorStop(1, color + '00');
                ctx.fillStyle = grd;
                ctx.fill();
            };

            drawLine(cpuHistory, C.accent);
            drawLine(ramHistory, C.blue);
        }

        // ── clock ────────────────────────────────────────────────────
        function updateTime() {
            uptimeSeconds++;
            const h = Math.floor(uptimeSeconds / 3600);
            const m = Math.floor((uptimeSeconds % 3600) / 60);
            const s = uptimeSeconds % 60;
            document.getElementById('uptime').textContent =
                `uptime: ${h}h ${m}m ${s}s`;
            document.getElementById('clock').textContent =
                new Date().toLocaleTimeString('en-US', { hour12: false });
        }

        // ── tick ─────────────────────────────────────────────────────
        function tick() {
            const cpuAvg = updateCores();
            const ramPct = updateRam();
            updateProcesses();
            updateTime();

            cpuHistory.push(cpuAvg); cpuHistory.shift();
            ramHistory.push(ramPct); ramHistory.shift();

            drawHistory();
        }

        // ── boot ─────────────────────────────────────────────────────
        initCores();
        initMemArc();
        renderDisks();

        const ro = new ResizeObserver(drawHistory);
        ro.observe(document.getElementById('historyChart'));

        setInterval(tick, 1200);
        tick();
    </script>
</body>

</html>